# Example vuln-pkg manifest
# Host this file and point vuln-pkg to it with --manifest-url

meta:
  author: "Mainasara Al-amin Tsowa"
  email: "tsowamainasara@gmail.com"
  url: "https://github.com/neutrino2211/vuln-kg"
  description: "A collection of vulnerable applications for security training"

apps:
  - name: dvwa
    version: "1.0"
    image: vulnerables/web-dvwa
    ports:
      - port: 80
        protocol: http
        label: Web UI
    tags:
      - CVE-2017-16651
      - SQL-Injection
      - XSS
      - CSRF
    description: "Damn Vulnerable Web Application - PHP/MySQL web app for security testing"
    env:
      - "MYSQL_ROOT_PASSWORD=dvwa"

  - name: juice-shop
    version: "14.0"
    image: bkimminich/juice-shop
    ports:
      - port: 3000
        label: Web UI
    tags:
      - OWASP-Top-10
      - Injection
      - Broken-Auth
    description: "OWASP Juice Shop - Modern vulnerable Node.js/Angular web application"

  - name: webgoat
    version: "8.2"
    image: webgoat/webgoat
    ports:
      - port: 8080
        label: WebGoat
      - port: 9090
        label: WebWolf
    tags:
      - OWASP-Top-10
    description: "OWASP WebGoat - Java-based deliberately insecure application"

  - name: hackazon
    version: "1.0"
    image: pierrickv/hackazon
    ports:
      - port: 80
        label: HTTP
      - port: 443
        label: HTTPS
    tags:
      - REST-API
      - SQL-Injection
    description: "Hackazon - Vulnerable test e-commerce site with REST API"

  - name: vampi
    version: "1.0"
    image: erev0s/vampi
    ports:
      - port: 5000
        label: REST API
    tags:
      - API-Security
      - OWASP-API-Top-10
    description: "VAmPI - Vulnerable REST API for API security testing"

  - name: react2shell
    version: "1.0"
    type: dockerfile
    dockerfile: |
      FROM node:20-alpine AS build-env
      WORKDIR /
      RUN npx create-next-app@16.0.1 app --app --ts --yes && cd app && npm run build
      FROM node:20-alpine
      COPY --from=build-env /app/package.json /app/package.json
      COPY --from=build-env /app/package-lock.json /app/package-lock.json
      COPY --from=build-env /app/node_modules /app/node_modules
      COPY --from=build-env /app/.next /app/.next
      WORKDIR /app
      EXPOSE 3000
      CMD ["npm", "start"]
    ports:
      - port: 3000
        label: React2Shell exposed port
    tags:
      - CVE-2025-55182
      - React2Shell
    description: "Custom SQL injection lab - built from inline Dockerfile"


  # Example: MongoDB with MongoBleed vulnerability (TCP protocol)
  - name: mongobleed
    version: "8.0.16"
    image: mongo:8.0.16
    ports:
      - port: 27017
        protocol: tcp
        label: MongoDB
    tags:
      - CVE-2025-14847
      - Memory-Leak
    description: "MongoDB with MongoBleed vulnerability - memory disclosure via zlib"


  # ==================== TCP/UDP Protocol Examples ====================

  # Example: MongoDB with MongoBleed vulnerability (TCP protocol)
  # - name: mongobleed
  #   version: "8.0.16"
  #   image: mongo:8.0.16
  #   ports:
  #     - port: 27017
  #       protocol: tcp
  #       label: MongoDB
  #   tags:
  #     - CVE-2025-14847
  #     - Memory-Leak
  #   description: "MongoDB with MongoBleed vulnerability - memory disclosure via zlib"

  # Example: Redis with unauthenticated access (TCP protocol)
  # - name: redis-unauth
  #   version: "6.0"
  #   image: redis:6.0
  #   ports:
  #     - port: 6379
  #       protocol: tcp
  #       label: Redis
  #   tags:
  #     - Unauthenticated
  #     - RCE
  #   description: "Redis without authentication - for testing unauthorized access"

  # Example: Mixed protocols (HTTP admin + TCP database)
  # - name: vulnerable-app-full
  #   version: "1.0"
  #   image: example/vulnerable-app
  #   ports:
  #     - port: 80
  #       protocol: http
  #       label: Web Admin
  #     - port: 3306
  #       protocol: tcp
  #       label: MySQL
  #     - port: 6379
  #       protocol: tcp
  #       label: Redis
  #   tags:
  #     - Multi-Service
  #   description: "Full stack vulnerable app with web UI and exposed databases"

  # ==================== Custom Package Examples ====================

  # Example: Dockerfile-based package (inline Dockerfile)
  # - name: custom-sqli-lab
  #   version: "1.0"
  #   type: dockerfile
  #   dockerfile: |
  #     FROM php:8.0-apache
  #     RUN docker-php-ext-install mysqli pdo pdo_mysql
  #     COPY index.php /var/www/html/
  #     RUN chmod 777 /var/www/html
  #     EXPOSE 80
  #   ports:
  #     - port: 80
  #       label: SQL Injection Lab
  #   tags:
  #     - SQL-Injection
  #     - Custom-Lab
  #   description: "Custom SQL injection lab - built from inline Dockerfile"

  # Example: Dockerfile-based package (remote Dockerfile)
  # - name: remote-vuln-app
  #   version: "1.0"
  #   type: dockerfile
  #   dockerfile_url: https://example.com/vuln-apps/sqli/Dockerfile
  #   context_url: https://example.com/vuln-apps/sqli/context.tar.gz
  #   ports: [8080]
  #   description: "Remote vulnerable app - fetches Dockerfile and context from URLs"

  # Example: Git-based package
  # - name: git-vuln-lab
  #   version: "1.0"
  #   type: git
  #   repo: https://github.com/example/vulnerable-app.git
  #   ref: main
  #   dockerfile_path: ./Dockerfile
  #   ports:
  #     - port: 3000
  #       label: Web UI
  #   tags:
  #     - Custom
  #   description: "Git-based vulnerable lab - cloned and built from repository"

# Signature placeholder - unsigned manifests show a warning
signature: null
